# domain-mcp-server

> Domain-aware MCP server for discovering business logic, APIs, and data
> models directly from your Git monorepo/microservices -- with results
> stored in PostgreSQL for fast, structured querying.

## Table of Contents

-   Overview
-   Key Features
-   Architecture
-   MCP Tools & Capabilities
-   Tech Stack
-   Configuration
-   Running Locally
-   Running in Kubernetes
-   Health Check
-   Security Notes
-   Limitations & Future Work
-   License

## Overview

`domain-mcp-server` is a Java MCP server that inspects Git repositories
and extracts domain knowledge (business rules, APIs, data models) using
a combination of static analysis and Claude LLM reasoning. All processed
data is normalized and stored in PostgreSQL using JDBI3.

## Key Features

-   Service-aware Git repository discovery
-   Reads claude.md, README.md, and inspects code
-   Summaries and structured metadata generated by Claude
-   PostgreSQL knowledge base (JDBI3)
-   SSE responses for long-running tasks
-   Git SSH access
-   Lightweight /health endpoint

## Architecture

1.  Query service via MCP tool.
2.  Check PostgreSQL.
3.  If new → clone repo via SSH.
4.  Parse files + analyze code.
5.  Send structured prompts to Claude.
6.  Store results in DB.
7.  Stream response via SSE.

## MCP Tools & Capabilities

-   describe-service
-   refresh-service
-   list-services
-   get-service-model

## Tech Stack

-   Java 21
-   Spring WebMVC
-   io.modelcontextprotocol.sdk (mcp + mcp-spring-webmvc)
-   JDBI3
-   PostgreSQL
-   Git SSH

## Configuration

Environment variables: - DOMAIN_MCP_DB_URL - DOMAIN_MCP_DB_USER -
DOMAIN_MCP_DB_PASSWORD - DOMAIN_MCP_CLAUDE_API_KEY -
DOMAIN_MCP_GIT_SSH_KEY - DOMAIN_MCP_GIT_BASE_URL -
DOMAIN_MCP_REPO_MAPPING

## Running Locally

    mvn clean package
    java -jar target/domain-mcp-server.jar

## Running in Kubernetes

Deploy using standard Deployment + Service manifests with Secrets for
DB, Claude key, and SSH key.

## Health Check

GET /health → "ok" or "up"

## Security Notes

Use Secrets for Claude key, DB credentials, and SSH key.

## Limitations & Future Work

-   Large repos take time to index
-   Multi-language enrichment planned
-   Incremental Git updates

## License
